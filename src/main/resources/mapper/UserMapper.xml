<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.dawnmoon.springboot_app_template.mapper.UserMapper">

    <!--
        XML映射文件策略：
        - 只包含复杂的查询逻辑（动态条件、多表JOIN等）
        - 简单查询直接在Mapper接口中使用 @Select 注解定义
        - 继承 BaseMapper 的通用 CRUD 操作不需要额外定义
    -->

    <!-- 根据关键词分页查询用户列表 - 复杂查询 + MyBatis-Plus 分页（通过 Page 参数自动拦截） -->
    <select id="selectUsersByKeyword" resultType="com.dawnmoon.springboot_app_template.model.entity.User">
        SELECT * FROM sys_user
        WHERE is_deleted = 0
        <if test="keyword != null and keyword != ''">
            AND (
                username LIKE CONCAT('%', #{keyword}, '%')
                OR real_name LIKE CONCAT('%', #{keyword}, '%')
                OR phone LIKE CONCAT('%', #{keyword}, '%')
                OR email LIKE CONCAT('%', #{keyword}, '%')
            )
        </if>
        ORDER BY create_at DESC
    </select>

</mapper>
